<!doctype html>
<html lang="es-AR"><head>
  <meta charset="utf-8"/>
  <meta content="width=device-width,initial-scale=1,viewport-fit=cover" name="viewport"/>
  <title>GB Production Board</title>
  <link href="css/styles.css?v=20251226-5" rel="stylesheet"/>
</head>
<body>
  <div class="shell">
    <aside class="sidebar">
      <div class="brand">
        <input class="titleInput" id="projectTitle" placeholder="Proyecto"/>
        <select class="input projectSwitch" id="projectSwitch" title="Proyecto"></select>
        
      </div>

      <nav class="nav">
        <button class="navBtn" data-view="breakdown">Breakdown</button>
        <button class="navBtn" data-view="shooting">Call Diario</button>
        <button class="navBtn" data-view="dayplan">Plan de Rodaje</button>
        <button class="navBtn" data-view="schedule">Plan General</button>
        <button class="navBtn" data-view="shotlist">Shotlist</button>
        <button class="navBtn" data-view="elements">Elementos</button>
        <button class="navBtn" data-view="crew">Equipo técnico</button>
        <button class="navBtn" data-view="reports">Filtros</button>
        <button class="navBtn" data-view="callsheet">REPORTES</button>
      </nav>

      
    </aside>

    <main class="main">
      <div class="toast" id="toast" style="display:none;"></div>
      <div class="hoverTip" id="hoverTip" style="display:none;"></div>

      <!-- ================= BREAKDOWN ================= -->
      <section class="view" id="view-breakdown">
        <!-- PRIMERO: Escenas + Editor -->
        <div class="grid2">
          <div class="card" id="sceneListCard">
            <div class="cardHeader">
              <h2 class="cardTitle">Escenas</h2>
              <div class="row gap">
                <button class="btn" id="btnAddScene">+ Escena</button>
                <button class="btn" id="btnDuplicateScene">Duplicar</button>
                <button class="btn danger" id="btnDeleteScene">Borrar</button>
              </div>
            </div>

            <div class="cardContent">
              <div class="row gap">
                <input class="input grow" id="sceneSearch" placeholder="Buscar escena…"/>
                <select class="input compact" id="sceneFilterTOD">
                  <option value="">TOD</option>
                  <option value="Día">Día</option>
                  <option value="Noche">Noche</option>
                  <option value="Amanecer">Amanecer</option>
                  <option value="Atardecer">Atardecer</option>
                </select>
              </div>

              <div class="tableWrap">
                <table class="table" id="sceneTable">
                  <thead>
                    <tr>
                      <th style="width:72px;">#</th>
                      <th>Título</th>
                      <th style="width:70px;">I/E</th>
                      <th>Lugar</th>
                      <th style="width:120px;">Momento</th>
                      <th style="width:90px;">Largo</th>
                    </tr>
                  </thead>
                  <tbody></tbody>
                </table>
              </div>
            </div>
          </div>

          <div class="card" id="sceneEditorCard">
            <div class="cardHeader">
              <h2 class="cardTitle">Editor</h2>
              <div class="muted small" id="selectedSceneHint">Seleccioná una escena</div>
            </div>

            <div class="cardContent">
              <div class="gridEditor">
                <div class="field">
                  <label>Nro</label>
                  <input class="input" id="scene_number"/>
                </div>
                <div class="field">
                  <label>Título</label>
                  <input class="input" id="scene_slugline"/>
                </div>
                <div class="field">
                  <label>Int / Ext</label>
                  <select class="input" id="scene_intExt">
                    <option value=""></option>
                    <option value="Int">Int</option>
                    <option value="Ext">Ext</option>
                  </select>
                </div>
                <div class="field">
                  <label>Lugar</label>
                  <input class="input" id="scene_location"/>
                </div>
                <div class="field">
                  <label>Momento del día</label>
                  <select class="input" id="scene_timeOfDay">
                    <option value=""></option>
                    <option value="Día">Día</option>
                    <option value="Noche">Noche</option>
                    <option value="Amanecer">Amanecer</option>
                    <option value="Atardecer">Atardecer</option>
                  </select>
                </div>
                <div class="field">
                  <label>Largo Páginas</label>
                  <input class="input" id="scene_pages" min="0" step="0.5" type="number"/>
                </div>
              </div>

              <div class="field">
                <label>Resumen</label>
                <textarea class="textarea smallArea" id="scene_summary"></textarea>
              </div>
              <div class="field">
                <label>Notas</label>
                <textarea class="textarea smallArea" id="scene_notes"></textarea>
              </div>

              <div class="row gap alignEnd">
                <div class="field">
                  <label>Categoría</label>
                  <select class="input" id="elCategory"></select>
                </div>
                <div class="field grow">
                  <label>Elemento</label>
                  <input class="input" id="elItem" list="elSuggestDatalist" placeholder="Ej: Pistola, Sombrero…"/>
                  <datalist id="elSuggestDatalist"></datalist>
                </div>
                <button class="btn primary" id="btnAddSceneElement">Agregar</button>
              </div>

              <div class="spacer"></div>
              <div id="sceneElementsGrid"></div>
              <div class="spacer"></div>
              <div class="row gap alignEnd">
                <div class="colTitle" style="margin:0;">Planos</div>
                <button class="btn" id="btnAddShot">+ Plano</button>
              </div>
              <div class="tableWrap shotsWrap">
                <table class="table" id="shotsTable">
                  <thead>
                    <tr>
                      <th style="width:56px;">#</th>
                      <th style="width:180px;">Tipo</th>
                      <th>Descripción</th>
                      <th style="width:72px;"></th>
                    </tr>
                  </thead>
                  <tbody></tbody>
                </table>
              </div>

            </div>
          </div>
        </div>

        <!-- ABAJO: importación (secundaria) + colapsable -->
        
          <div class="grid2">
            <div class="card collapsible collapsed span2" data-collapse-key="bd_script">
              <div class="cardHeader">
                <div class="cardTitle">GUION EN EL BREAKDOWN <span class="keepcase">(versión y planos)</span></div>
                <div class="collapseToggle" title="Expandir/Colapsar">▸</div>
              </div>
              <div class="cardContent">
                <div class="row gap">
                  <select class="input" id="scriptVerSelect" style="max-width:240px"></select>
                  <button class="btn" id="btnNewScriptVersion">Nueva versión</button>
                  <button class="btn ghost" id="btnToggleScriptImport">Pegar / Procesar</button>
                  <span class="pill" id="scriptVerMeta">—</span>
                </div>

                <div class="scriptWrap" id="scriptVersionUI" style="display:none">
                  <div class="scriptLeft">
                    <div class="muted small">Escenas de la versión (doble click = editar en el proyecto)</div>
                    <div class="scriptList" id="scriptSceneList"></div>
                    <div class="row gap">
                      <button class="btn" id="btnScriptInsertAfter">+ Escena (6A)</button>
                      <button class="btn" id="btnScriptApply">Incorporar cambios al proyecto</button>
                    </div>
                  </div>

                  <div class="scriptRight">
                    <div class="muted small">Editor de escena (versión)</div>
                    <div class="row gap">
                      <div class="grow">
                        <label class="small">Título</label>
                        <input class="input" id="scriptSceneSlugline" placeholder="INT. CASA - DÍA"/>
                      </div>
                      <div style="max-width:120px">
                        <label class="small">Nº</label>
                        <input class="input" id="scriptSceneNumber" placeholder="6A"/>
                      </div>
                    </div>
                    <div class="row gap">
                      <div class="grow">
                        <label class="small">Lugar</label>
                        <input class="input" id="scriptSceneLocation" placeholder="LIVING"/>
                      </div>
                      <div style="max-width:140px">
                        <label class="small">Momento</label>
                        <select class="input" id="scriptSceneTOD">
                          <option>Día</option><option>Noche</option><option>Atardecer</option><option>Amanecer</option>
                        </select>
                      </div>
                    </div>
                    <label class="small">Texto de escena</label>
                    <textarea class="input" id="scriptSceneBody" placeholder="Escribí o pegá acá el texto de la escena…" rows="16"></textarea>

                    <div class="row gap" style="justify-content:flex-end">
                      <button class="btn" id="btnScriptSaveScene">Guardar cambios</button>
                    </div>

                    <div class="scriptImportPanel hidden" id="scriptImportPanel">
                      <div class="muted small">Pegá el guion completo acá y lo proceso a escenas (reemplaza la versión actual).</div>
                      <textarea class="input" id="scriptImportText" placeholder="INT./EXT. por línea, como guion tradicional…" rows="8"></textarea>
                      <div class="row gap" style="align-items:flex-end">
                        <div class="grow">
                          <label class="small">Palabras clave (opcional)</label>
                          <input class="input" id="scriptKeywords" placeholder="Ej: lluvia, persecución, dron…"/>
                        </div>
                        <button class="btn" id="btnParseScript">Procesar</button>
                        <button class="btn ghost" id="btnCancelScriptImport">Ocultar</button>
                      </div>
                    </div>

                  </div>
                </div>

                <div class="divider"></div>
                <div class="muted small">Cómo usarlo</div>
                <ol class="small">
                  <li>Creá una versión nueva, pegá el guion (o editá las escenas acá).</li>
                  <li>Insertá escenas intermedias: 6 → 6A → 6B…</li>
                  <li>Cuando esté OK, incorporá al proyecto (se sincroniza).</li>
                </ol>
                <div class="muted small">Tip: en el guion, el buscador de escenas funciona si el slugline arranca con INT./EXT.</div>
              </div>
            </div>
          </div>

      </section>

      <!-- ================= PLAN DE RODAJE ================= -->
      <section class="view hidden" id="view-shooting">
        <div class="shootingLayout" id="shootingLayout">
          <!-- Banco -->
          <div class="col" id="bankCol">
            <div class="card bankCard">
              <div class="cardHeader bankHeader" id="sceneBankHeader">
                <h2 class="cardTitle">Banco de Escenas</h2>
                <button class="btn icon" id="btnToggleBank" title="Colapsar/expandir">⟨</button>
              </div>

              <div class="cardContent" id="sceneBankBody">
                <div class="row gap">
                  <input class="input grow" id="bankSearch" placeholder="Buscar…"/>
                  <select class="input compact" id="bankFilter">
                    <option value="all">Todas</option>
                    <option value="unassigned">No asignadas</option>
                  </select>
                </div>
                <div class="bankList" id="sceneBankList"></div>
              </div>
            </div>

            <!-- Dock visible cuando está colapsado -->
            <div class="bankDock hidden" id="bankDock">
              <button class="btn icon" id="btnToggleBankDock" title="Expandir">⟩</button>
            </div>
          </div>

          <!-- Tablero + Detalle -->
          <div class="col">
            <div class="card" id="daysBoardCard">
              <div class="cardHeader">
                <h2 class="cardTitle">Tablero de Días</h2>
                <div class="row gap">
                  <button class="btn" id="btnAddShootDay">+ Día</button>
                  <button class="btn danger" id="btnDeleteShootDay">Borrar Día</button>
                </div>
              </div>
              <div class="cardContent">
                <div class="daysBoardWrap" id="daysBoardWrap">
                  <div class="daysBoard" id="daysBoard"></div>
              </div>
            </div>

            <div class="card" id="dayDetailCard">
              <div class="cardHeader">
                <h2 class="cardTitle" id="dayDetailTitle">Detalle del Día</h2>
                <button class="btn" id="btnOpenCallSheet">Ver Call Sheet</button>
              </div>

              <div class="cardContent">
                <div class="dayDetail3col">
  <!-- Col 1 -->
  <div class="col">
    <div class="heroBlock">
    <div class="field">
      <label>Fecha</label>
      <input class="input" id="day_date" type="date"/>
    </div>

    <div class="field">
      <label>Call Time</label>
      <div class="row gap">
        <button class="btn icon" id="day_call_minus" title="-15">−</button>
        <input class="input grow" id="day_call" placeholder="08:00"/>
        <button class="btn icon" id="day_call_plus" title="+15">+</button>
      </div>
    </div>
    </div>

    <div class="field">
      <label>Locación</label>
      <input class="input" id="day_location"/>
    </div>

    <div class="field">
      <label>Nombre</label>
      <input class="input" id="day_label"/>
    </div>

    <div class="field">
      <label>Notas</label>
      <textarea class="textarea smallArea" id="day_notes"></textarea>
    </div>
  </div>

  <!-- Col 2 -->
  <div class="col">
    <div class="colTitle">Cast citado (auto)</div>
    <div id="dayCast"></div>
  </div>

  <!-- Col 4 -->
  <div class="col">
    <div class="colTitle">Equipo técnico</div>
    <div id="dayCrewPicker"></div>
  </div>
</div>
                </div>
              </div>
            </div>

          </div>
        </div>
      </section>


      <!-- ================= PLAN DE RODAJE (Vista diaria) ================= -->
      <section class="view hidden" id="view-dayplan">
        <div class="shootingLayout dayplanLayout" id="dayplanLayout">
          <!-- Banco -->
          <div class="col" id="dpBankCol">
            <div class="card bankCard">
              <div class="cardHeader bankHeader" id="dpSceneBankHeader">
                <h2 class="cardTitle">Banco de Escenas</h2>
                <button class="btn icon" id="dpBtnToggleBank" title="Colapsar/expandir">⟨</button>
              </div>

              <div class="cardContent" id="dpSceneBankBody">
                <div class="row gap">
                  <input class="input grow" id="dpBankSearch" placeholder="Buscar…"/>
                  <select class="input compact" id="dpBankFilter">
                    <option value="all">Todas</option>
                    <option value="unassigned">No asignadas</option>
                  </select>
                </div>
                <div class="bankList" id="dpSceneBankList"></div>
              </div>
            </div>

            <!-- Dock visible cuando está colapsado -->
            <div class="bankDock hidden" id="dpBankDock">
              <button class="btn icon" id="dpBtnToggleBankDock" title="Expandir">⟩</button>
            </div>
          </div>

          <!-- Plan -->
          <div class="col">
            <div class="card" id="dayplanCard">
          <div class="cardHeader">
            <h2 class="cardTitle">Plan de Rodaje</h2>
            <div class="row gap noPrint" style="flex-wrap:wrap">
              <select class="input compact" id="dayplanSelect"></select>

              <div class="row gap" style="align-items:center">
                <span class="muted">Snap</span>
                <select class="input compact" id="dayplanSnap" style="width:90px">
                  <option value="5">5m</option>
                  <option value="10">10m</option>
                  <option value="15" selected>15m</option>
                  <option value="30">30m</option>
                </select>
              </div>

              <button class="btn" id="btnDayplanAddNote">+ Nota / tarea</button>
              <button class="btn ghost" id="btnDayplanAuto" title="Acomoda el horario sin solaparse">Auto</button>
              <button class="btn" id="btnDayplanPrint">Imprimir</button>
            </div>
          </div>

          <div class="cardContent">
            <div id="dayplanHead"></div>
            <div class="spacer"></div>
            <div class="dayplanBody">

            <div class="dpScroller screenOnly" id="dpScroller">
              <div class="dpTimeCol" id="dpTimeCol"></div>
              <div class="dpLane" id="dpLane"></div>
            </div>

            
<div class="dayplanInspector noPrint" id="dayplanInspector"></div>
            </div>


            <div class="printOnly" id="dayplanPrint"></div>
</div>
        </div>
          </div>
        </div>
      </section>

      <!-- ================= CRONOGRAMA ================= -->
      <section class="view hidden" id="view-schedule">
        <div class="card" id="scheduleCard">
          <div class="cardHeader">
            <h2 class="cardTitle">Plan General</h2>
            <div class="row gap">
              <input class="input" id="schedSearch" placeholder="Buscar…" style="max-width:260px"/>
              <label class="row gap small muted">Zoom
                <select class="input compact" id="schedZoom">
                  <option value="60">Bajo</option>
                  <option selected="" value="90">Medio</option>
                  <option value="120">Grande</option>
                  <option value="160">Gigante</option>
                </select>
              </label>
              <label class="row gap small muted">Snap
                <select class="input compact" id="schedSnap">
                  <option value="5">5 min</option>
                  <option value="10">10 min</option>
                  <option selected="" value="15">15 min</option>
                  <option value="30">30 min</option>
                </select>
              </label>
            </div>
          </div>
          <div class="cardContent scheduleContent">
            <!-- Scroll horizontal superior (siempre accesible) -->
            <div class="schedScrollTop" id="schedScrollTop">
              <div class="schedScrollTopInner" id="schedScrollTopInner"></div>
            </div>

            <div class="schedWrap" id="schedWrap">
              <div class="schedBoard" id="schedBoard"></div>
            </div>
          </div>
        </div>
      </section>

      <!-- ================= SHOTLIST ================= -->
      <section class="view hidden" id="view-shotlist">
        <div class="card" id="shotlistCard">
          <div class="cardHeader">
            <h2 class="cardTitle">Shotlist</h2>
            <div class="row gap noPrint">
              <select class="input compact" id="shotDaySelect"></select>
              <button class="btn" id="btnShotPrint">Imprimir</button>
            </div>
          </div>
          <div class="cardContent">
            <div class="muted small" id="shotlistSummary">—</div>
            <div class="spacer"></div>
            <div id="shotlistWrap"></div>
          </div>
        </div>
      </section>

      <!-- ================= ELEMENTOS ================= -->
      <section class="view hidden" id="view-elements">
        <div class="grid2">
          <div class="card">
            <div class="cardHeader">
              <h2 class="cardTitle">Explorar elementos</h2>
            </div>
            <div class="cardContent">
              <div class="row gap">
                <select class="input compact" id="elxCategory"></select>
                <select class="input compact" id="elxDay"></select>
                <input class="input grow" id="elxSearch" placeholder="Buscar elemento…"/>
              </div>
              <div class="spacer"></div>
              <div id="elxList"></div>
            </div>
          </div>
          <div class="card">
            <div class="cardHeader">
              <h2 class="cardTitle">Detalle</h2>
            </div>
            <div class="cardContent">
              <div id="elxDetail"></div>
            </div>
        </div>
      </div></section>

      <!-- ================= CREW ================= -->
      <section class="view hidden" id="view-crew">
        <div class="card" id="crewCard">
          <div class="cardHeader">
            <h2 class="cardTitle">Equipo técnico <span class="keepcase">(incluye Cast como área)</span></h2>
            <div class="row gap">
              <input class="input grow" id="crewSearch" placeholder="Buscar por área / rol / nombre…"/>
              <button class="btn" id="btnAddCrew">+ Integrante</button>
            </div>
          </div>
          <div class="cardContent">
            <div class="tableWrap">
              <table class="table" id="crewTable">
                <thead>
                  <tr>
                    <th style="width:190px;">Área</th>
                    <th style="width:200px;">Rol</th>
                    <th>Nombre</th>
                    <th style="width:140px;">Tel</th>
                    <th style="width:220px;">Email</th>
                    <th>Notas</th>
                    <th style="width:110px;"></th>
                  </tr>
                </thead>
                <tbody></tbody>
              </table>
            </div>
        </div>
      </div></section>

      <!-- ================= REPORTES ================= -->
      <section class="view hidden" id="view-reports">
        <div class="card">
          <div class="cardHeader">
            <h2 class="cardTitle">Filtros</h2>
          </div>
          <div class="cardContent">
            <div class="row gap" style="margin-bottom:10px">
              <input class="input grow" id="reportsSearch" placeholder="Buscar…"/>
            </div>
            <div class="chips" id="reportsFilters" style="margin-bottom:10px"></div>
            <div class="reportsBoard" id="reportsBoard"></div>
          </div>
        </div>
      </section>

      <!-- ================= CALL SHEETS ================= -->
      <section class="view hidden" id="view-callsheet">
        <div class="grid2">
          <div class="card noPrint" id="callCalCard">
            <div class="cardHeader">
              <h2 class="cardTitle">Calendario</h2>
              <div class="row gap">
                <button class="btn icon" id="calPrev" title="Mes anterior">‹</button>
                <div class="muted" id="calTitle"></div>
                <button class="btn icon" id="calNext" title="Mes siguiente">›</button>
              </div>
            </div>
            <div class="cardContent">
              <div class="calGrid" id="calGrid"></div>
            </div>
          </div>

          <div class="card" id="callDetailCard">
            <div class="cardHeader">
              <h2 class="cardTitle">REPORTES</h2>
              <button class="btn primary" id="btnPrintCallSheet">Imprimir</button>
            </div>
            <div class="cardContent">
              <div class="reportTabs screenOnly" id="reportTabs">
                <button class="btn reportTabBtn" data-tab="dayplan">Plan de Rodaje</button>
                <button class="btn reportTabBtn active" data-tab="callsheet">Call Sheet</button>
                <button class="btn reportTabBtn" data-tab="shotlist">Shotlist</button>
              </div>

              <div id="reportPane-dayplan" class="reportPane hidden">
                <div id="reportDayplanDetail"></div>
              </div>
              <div id="reportPane-callsheet" class="reportPane">
                <div id="callSheetDetail"></div>
              </div>
              <div id="reportPane-shotlist" class="reportPane hidden">
                <div id="reportShotlistDetail"></div>
              </div>
            </div>
        </div>
      </div></section>

      <!-- ================= SETTINGS ================= -->
      

    </main>
  </div>

  <script src="js/utils.js?v=20251226-2"></script>
  <script src="js/storage.js?v=20251226-2"></script>
  <script src="js/app.js?v=20251226-4"></script>


</body></html>